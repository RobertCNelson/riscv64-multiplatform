From 634d8859d18ba2809d3e00b7e32d7376a2615e02 Mon Sep 17 00:00:00 2001
From: Tom <support@vamrs.com>
Date: Tue, 20 Apr 2021 14:29:27 +0800
Subject: [PATCH 31/38] defconfig: fix for StarFive VIC7100 default config for
 fedora

[FIXME]Disable PM temporarily for kernel stable
---
 ...arfive_vic7100_evb_sd_net_fedora_defconfig | 42 +++++++------------
 1 file changed, 15 insertions(+), 27 deletions(-)

diff --git a/arch/riscv/configs/starfive_vic7100_evb_sd_net_fedora_defconfig b/arch/riscv/configs/starfive_vic7100_evb_sd_net_fedora_defconfig
index 7f492cd698c7..331e2d50a58b 100644
--- a/arch/riscv/configs/starfive_vic7100_evb_sd_net_fedora_defconfig
+++ b/arch/riscv/configs/starfive_vic7100_evb_sd_net_fedora_defconfig
@@ -266,6 +266,7 @@ CONFIG_FPGA_GMAC_SPEED_AUTO=y
 CONFIG_FPGA_GMAC_FLUSH_DDR=y
 CONFIG_MMC_DW_FLUSH_DDR=y
 CONFIG_USB_CDNS3_HOST_FLUSH_DMA=y
+CONFIG_SOC_STARFIVE_VIC7100_I2C_GPIO=y
 # end of StarFive VIC7100 SoC Debug Option
 
 CONFIG_SOC_VIRT=y
@@ -319,18 +320,7 @@ CONFIG_EFI=y
 #
 # Power management options
 #
-CONFIG_PM_SLEEP=y
-# CONFIG_PM_AUTOSLEEP is not set
-# CONFIG_PM_WAKELOCKS is not set
-CONFIG_PM=y
-CONFIG_PM_DEBUG=y
-# CONFIG_PM_ADVANCED_DEBUG is not set
-CONFIG_PM_SLEEP_DEBUG=y
-CONFIG_PM_CLK=y
-CONFIG_PM_GENERIC_DOMAINS=y
-# CONFIG_WQ_POWER_EFFICIENT_DEFAULT is not set
-CONFIG_PM_GENERIC_DOMAINS_SLEEP=y
-CONFIG_PM_GENERIC_DOMAINS_OF=y
+# CONFIG_PM is not set
 # end of Power management options
 
 #
@@ -489,7 +479,6 @@ CONFIG_EFI_PARTITION=y
 CONFIG_BLK_MQ_PCI=y
 CONFIG_BLK_MQ_VIRTIO=y
 CONFIG_BLK_MQ_RDMA=y
-CONFIG_BLK_PM=y
 
 #
 # IO Schedulers
@@ -1423,7 +1412,6 @@ CONFIG_BT_HCIBTSDIO=m
 CONFIG_BT_HCIUART=m
 CONFIG_BT_HCIUART_SERDEV=y
 CONFIG_BT_HCIUART_H4=y
-CONFIG_BT_HCIUART_NOKIA=m
 CONFIG_BT_HCIUART_BCSP=y
 CONFIG_BT_HCIUART_ATH3K=y
 CONFIG_BT_HCIUART_LL=y
@@ -1567,7 +1555,6 @@ CONFIG_PCIEASPM_DEFAULT=y
 # CONFIG_PCIEASPM_POWERSAVE is not set
 # CONFIG_PCIEASPM_POWER_SUPERSAVE is not set
 # CONFIG_PCIEASPM_PERFORMANCE is not set
-CONFIG_PCIE_PME=y
 CONFIG_PCIE_DPC=y
 CONFIG_PCIE_PTM=y
 # CONFIG_PCIE_BW is not set
@@ -1686,7 +1673,6 @@ CONFIG_EXTRA_FIRMWARE=""
 CONFIG_FW_LOADER_USER_HELPER=y
 # CONFIG_FW_LOADER_USER_HELPER_FALLBACK is not set
 CONFIG_FW_LOADER_COMPRESS=y
-CONFIG_FW_CACHE=y
 # end of Firmware loader
 
 CONFIG_WANT_DEV_COREDUMP=y
@@ -1713,7 +1699,6 @@ CONFIG_GENERIC_ARCH_TOPOLOGY=y
 # Bus devices
 #
 # CONFIG_MOXTET is not set
-# CONFIG_SIMPLE_PM_BUS is not set
 CONFIG_MHI_BUS=m
 # CONFIG_MHI_BUS_DEBUG is not set
 # end of Bus devices
@@ -2827,7 +2812,6 @@ CONFIG_ATH9K_AHB=y
 CONFIG_ATH9K_DEBUGFS=y
 # CONFIG_ATH9K_STATION_STATISTICS is not set
 # CONFIG_ATH9K_DYNACK is not set
-# CONFIG_ATH9K_WOW is not set
 CONFIG_ATH9K_RFKILL=y
 # CONFIG_ATH9K_CHANNEL_CONTEXT is not set
 CONFIG_ATH9K_PCOEM=y
@@ -3410,7 +3394,6 @@ CONFIG_TTY=y
 CONFIG_VT=y
 CONFIG_CONSOLE_TRANSLATIONS=y
 CONFIG_VT_CONSOLE=y
-CONFIG_VT_CONSOLE_SLEEP=y
 CONFIG_HW_CONSOLE=y
 CONFIG_VT_HW_CONSOLE_BINDING=y
 CONFIG_UNIX98_PTYS=y
@@ -4686,10 +4669,7 @@ CONFIG_V4L_PLATFORM_DRIVERS=y
 # CONFIG_VIDEO_ASPEED is not set
 # CONFIG_VIDEO_MUX is not set
 # CONFIG_VIDEO_XILINX is not set
-CONFIG_VIDEO_STARFIVE_VIN=y
-# CONFIG_VIDEO_STARFIVE_VIN_SENSOR_OV5640 is not set
-CONFIG_VIDEO_STARFIVE_VIN_SENSOR_IMX219=y
-# CONFIG_VIDEO_STARFIVE_VIN_SENSOR_SC2235 is not set
+# CONFIG_VIDEO_STARFIVE_VIN is not set
 CONFIG_V4L_MEM2MEM_DRIVERS=y
 # CONFIG_VIDEO_MEM2MEM_DEINTERLACE is not set
 # CONFIG_DVB_PLATFORM_DRIVERS is not set
@@ -5300,7 +5280,6 @@ CONFIG_FB_SSD1307=m
 # CONFIG_FB_STARFIVE_HDMI_ADV7513 is not set
 CONFIG_FB_STARFIVE_HDMI_TDA998X=y
 # CONFIG_FB_STARFIVE_SEEED5INCH is not set
-# CONFIG_FB_STARFIVE_VIDEO is not set
 # end of Displayer Configuration for VIC board
 # end of Frame buffer Devices
 
@@ -5487,7 +5466,6 @@ CONFIG_SND_HDA_CODEC_CA0132_DSP=y
 CONFIG_SND_HDA_CODEC_CMEDIA=m
 CONFIG_SND_HDA_CODEC_SI3054=m
 CONFIG_SND_HDA_GENERIC=m
-CONFIG_SND_HDA_POWER_SAVE_DEFAULT=0
 CONFIG_SND_HDA_INTEL_HDMI_SILENT_STREAM=y
 # end of HD-Audio
 
@@ -5903,7 +5881,6 @@ CONFIG_USB_ANNOUNCE_NEW_DEVICES=y
 CONFIG_USB_DEFAULT_PERSIST=y
 # CONFIG_USB_FEW_INIT_RETRIES is not set
 # CONFIG_USB_DYNAMIC_MINORS is not set
-# CONFIG_USB_OTG is not set
 # CONFIG_USB_OTG_PRODUCTLIST is not set
 CONFIG_USB_LEDS_TRIGGER_USBPORT=m
 CONFIG_USB_AUTOSUSPEND_DELAY=2
@@ -5959,7 +5936,6 @@ CONFIG_USB_TMC=m
 CONFIG_USB_STORAGE=m
 # CONFIG_USB_STORAGE_DEBUG is not set
 CONFIG_USB_STORAGE_REALTEK=m
-CONFIG_REALTEK_AUTOPM=y
 CONFIG_USB_STORAGE_DATAFAB=m
 CONFIG_USB_STORAGE_FREECOM=m
 CONFIG_USB_STORAGE_ISD200=m
@@ -6489,6 +6465,7 @@ CONFIG_UDMABUF=y
 # CONFIG_DMABUF_SELFTESTS is not set
 CONFIG_DMABUF_HEAPS=y
 CONFIG_DMABUF_HEAPS_SYSTEM=y
+# CONFIG_DMABUF_HEAPS_CMA is not set
 # end of DMABUF options
 
 CONFIG_AUXDISPLAY=y
@@ -8194,6 +8171,17 @@ CONFIG_ARCH_DMA_ADDR_T_64BIT=y
 CONFIG_DMA_DECLARE_COHERENT=y
 CONFIG_SWIOTLB=y
 CONFIG_DMA_CMA=y
+# CONFIG_DMA_PERNUMA_CMA is not set
+
+#
+# Default contiguous memory area size:
+#
+CONFIG_CMA_SIZE_MBYTES=16
+CONFIG_CMA_SIZE_SEL_MBYTES=y
+# CONFIG_CMA_SIZE_SEL_PERCENTAGE is not set
+# CONFIG_CMA_SIZE_SEL_MIN is not set
+# CONFIG_CMA_SIZE_SEL_MAX is not set
+CONFIG_CMA_ALIGNMENT=8
 # CONFIG_DMA_API_DEBUG is not set
 CONFIG_SGL_ALLOC=y
 CONFIG_CHECK_SIGNATURE=y
-- 
2.30.0

